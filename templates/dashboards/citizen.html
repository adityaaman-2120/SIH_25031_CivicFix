{% extends 'base.html' %}
{% load static %}
{% block title %}Citizen Dashboard - CivicFix{% endblock %}
{% block extra_css %}
  <link rel="stylesheet" href="{% static 'css/citizen.css' %}">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
{% endblock %}
{% block content %}


    <!-- Background Animation -->
    <div class="background-animation">
        <div class="floating-shapes">
            <div class="shape shape-1"></div>
            <div class="shape shape-2"></div>
            <div class="shape shape-3"></div>
            <div class="shape shape-4"></div>
        </div>
    </div>

    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="logo">
                <svg width="32" height="32" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M12 2L13.09 8.26L20 9L13.09 9.74L12 16L10.91 9.74L4 9L10.91 8.26L12 2Z" fill="currentColor"/>
                </svg>
                <span class="logo-text">CivicFix</span>
            </div>
            <button class="sidebar-toggle" id="sidebarToggle">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M3 12H21M3 6H21M3 18H21" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                </svg>
            </button>
        </div>
        
        <nav class="sidebar-nav">
            <ul class="nav-list">
                <li class="nav-item active">
                    <a href="#" class="nav-link" data-section="dashboard">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M3 13H11V3H3V13ZM3 21H11V15H3V21ZM13 21H21V11H13V21ZM13 3V9H21V3H13Z" fill="currentColor"/>
                        </svg>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="complaints">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2C13.1 2 14 2.9 14 4C14 5.1 13.1 6 12 6C10.9 6 10 5.1 10 4C10 2.9 10.9 2 12 2ZM21 9V7L15 1L9 7V9H21ZM12 8L14 10H10L12 8ZM5 12V22H19V12H5ZM7 14H17V20H7V14Z" fill="currentColor"/>
                        </svg>
                        <span>My Complaints</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="track">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 2C6.48 2 2 6.48 2 12S6.48 22 12 22 22 17.52 22 12 17.52 2 12 2ZM13 17H11V15H13V17ZM13 13H11V7H13V13Z" fill="currentColor"/>
                        </svg>
                        <span>Track Status</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="notifications">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 22C13.1 22 14 21.1 14 20H10C10 21.1 10.89 22 12 22ZM18 16V11C18 7.93 16.36 5.36 13.5 4.68V4C13.5 3.17 12.83 2.5 12 2.5S10.5 3.17 10.5 4V4.68C7.63 5.36 6 7.92 6 11V16L4 18V19H20V18L18 16Z" fill="currentColor"/>
                        </svg>
                        <span>Notifications</span>
                        <span class="notification-badge">3</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#" class="nav-link" data-section="profile">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V20H20V18C20 15.34 14.67 14 12 14Z" fill="currentColor"/>
                        </svg>
                        <span>Profile</span>
                    </a>
                </li>
            </ul>
        </nav>
        
        <div class="sidebar-footer">
            <a href="login.html" class="logout-btn">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M17 7L15.59 8.41L18.17 11H8V13H18.17L15.59 15.59L17 17L22 12L17 7ZM4 5H12V3H4C2.9 3 2 3.9 2 5V19C2 20.1 2.9 21 4 21H12V19H4V5Z" fill="currentColor"/>
                </svg>
                <span>Logout</span>
            </a>
        </div>
    </aside>

    <!-- Mobile Overlay -->
    <div class="mobile-overlay" id="mobileOverlay"></div>

    <!-- Main Content -->
    <main class="main-content" id="mainContent">
        <!-- Header -->
        <header class="dashboard-header">
            <div class="header-content">
                <div class="welcome-section">
                    <div class="user-avatar">
                        <svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M12 12C14.21 12 16 10.21 16 8C16 5.79 14.21 4 12 4C9.79 4 8 5.79 8 8C8 10.21 9.79 12 12 12ZM12 14C9.33 14 4 15.34 4 18V20H20V18C20 15.34 14.67 14 12 14Z" fill="currentColor"/>
                        </svg>
                    </div>
                    <div class="welcome-text">
                      <h1 class="display-6 mb-2">Hello, {{ request.user.first_name|default:request.user.username }}</h1>
                        <p>Welcome back to your CivicFix dashboard</p>
                    </div>
                </div>
                <div class="header-actions">
                    <a href="{% url 'complaints_page_api' %}" class="action-btn new-complaint-btn">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z" fill="currentColor"/>
                        </svg>
                        New Complaint
                    </a>
                </div>
            </div>
        </header>

        <!-- Dynamic Content Container -->
        <div class="content-container" id="contentContainer">
            <!-- Dashboard Section (Default) -->
            <section class="content-section active" id="dashboard-section">
                <!-- Stats Cards -->
                <div class="stats-section">
                    <div class="stats-grid">
                        <div class="stat-card total">
                            <div class="stat-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19ZM17 12H7V10H17V12ZM17 16H7V14H17V16ZM17 8H7V6H17V8Z" fill="currentColor"/>
                                </svg>
                            </div>
                            <div class="stat-content">
                                <h3>Total Complaints</h3>
                                <div class="stat-number">15</div>
                                <div class="stat-trend">+2 this month</div>
                            </div>
                        </div>

                        <div class="stat-card pending">
                            <div class="stat-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 2C6.48 2 2 6.48 2 12S6.48 22 12 22 22 17.52 22 12 17.52 2 12 2ZM13 17H11V15H13V17ZM13 13H11V7H13V13Z" fill="currentColor"/>
                                </svg>
                            </div>
                            <div class="stat-content">
                                <h3>Pending</h3>
                                <div class="stat-number">6</div>
                                <div class="stat-trend">Awaiting review</div>
                            </div>
                        </div>

                        <div class="stat-card progress">
                            <div class="stat-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M12 2C6.48 2 2 6.48 2 12S6.48 22 12 22 22 17.52 22 12 17.52 2 12 2ZM10 17L5 12L6.41 10.59L10 14.17L17.59 6.58L19 8L10 17Z" fill="currentColor"/>
                                </svg>
                            </div>
                            <div class="stat-content">
                                <h3>In Progress</h3>
                                <div class="stat-number">2</div>
                                <div class="stat-trend">Being addressed</div>
                            </div>
                        </div>

                        <div class="stat-card resolved">
                            <div class="stat-icon">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                    <path d="M9 16.17L4.83 12L3.41 13.41L9 19L21 7L19.59 5.59L9 16.17Z" fill="currentColor"/>
                                </svg>
                            </div>
                            <div class="stat-content">
                                <h3>Resolved</h3>
                                <div class="stat-number">7</div>
                                <div class="stat-trend">Successfully fixed</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recent Complaints Preview -->
                <div class="complaints-section">
                    <div class="section-header">
                        <h2>Recent Complaints</h2>
                        <button class="view-all-btn" onclick="switchSection('complaints')">View All</button>
                    </div>
                    <div class="complaints-grid" id="recentComplaintsGrid">
                        <!-- Recent complaints will be populated by JavaScript -->
                    </div>
                </div>

                <!-- Quick Notifications -->
                <div class="notifications-section">
                    <div class="section-header">
                        <h2>Recent Notifications</h2>
                        <button class="view-all-btn" onclick="switchSection('notifications')">View All</button>
                    </div>
                    <div class="notifications-list" id="quickNotificationsList">
                        <!-- Quick notifications will be populated by JavaScript -->
                    </div>
                </div>
            </section>

            <!-- My Complaints Section -->
            <section class="content-section" id="complaints-section">
                <div class="section-title">
                    <h1>My Complaints</h1>
                    <p>Manage and track all your submitted complaints</p>
                </div>
                
                <div class="filter-bar">
                    <div class="filter-controls">
                        <select class="filter-select" id="statusFilter">
                            <option value="all">All Status</option>
                            <option value="pending">Pending</option>
                            <option value="progress">In Progress</option>
                            <option value="resolved">Resolved</option>
                        </select>
                        <select class="filter-select" id="categoryFilter">
                            <option value="all">All Categories</option>
                            <option value="roads">Roads</option>
                            <option value="lights">Street Lights</option>
                            <option value="garbage">Garbage</option>
                            <option value="water">Water</option>
                            <option value="maintenance">Maintenance</option>
                        </select>
                        <a href="{% url 'complaints_page_api' %}" class="action-btn new-complaint-btn">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M19 13H13V19H11V13H5V11H11V5H13V11H19V13Z" fill="currentColor"/>
                            </svg>
                            New Complaint
                        </a>
                    </div>
                </div>
                
                <div class="complaints-grid" id="allComplaintsGrid">
                    <!-- All complaints will be populated by JavaScript -->
                </div>
            </section>

            <!-- Track Status Section -->
            <section class="content-section" id="track-section">
                <div class="section-title">
                    <h1>Track Status</h1>
                    <p>Monitor the progress of your complaints</p>
                </div>
                
                <div class="tracking-container" id="trackingContainer">
                    <!-- Tracking content will be populated by JavaScript -->
                </div>
            </section>

            <!-- Notifications Section -->
            <section class="content-section" id="notifications-section">
                <div class="section-title">
                    <h1>Notifications</h1>
                    <p>Stay updated on your complaint status changes</p>
                </div>
                
                <div class="notifications-controls">
                    <button class="mark-all-read" id="markAllRead">Mark all as read</button>
                    <div class="notification-filters">
                        <button class="filter-btn active" data-filter="all">All</button>
                        <button class="filter-btn" data-filter="unread">Unread</button>
                        <button class="filter-btn" data-filter="updates">Updates</button>
                    </div>
                </div>
                
                <div class="notifications-list detailed" id="detailedNotificationsList">
                    <!-- Detailed notifications will be populated by JavaScript -->
                </div>
            </section>

            <!-- Profile Section -->
            <section class="content-section" id="profile-section">
                <div class="section-title">
                    <h1>Profile Settings</h1>
                    <p>Manage your account information and preferences</p>
                </div>
                
                <div class="profile-container" id="profileContainer">
                    <!-- Profile content will be populated by JavaScript -->
                </div>
            </section>
        </div>
    </main>

{% block extra_js %}
<script src="{% static 'js/dashboard.js' %}"></script>
{% endblock %}

{% endblock %}